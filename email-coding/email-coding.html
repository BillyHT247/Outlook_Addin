<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8" />
  <title>Email Coding</title>
  <script src="https://appsforoffice.microsoft.com/lib/1/hosted/office.js"></script>
  <style>
    body {
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      margin: 12px;
      font-size: 13px;
    }

    h3 {
      margin-top: 0;
      margin-bottom: 8px;
      font-size: 16px;
    }

    label {
      display: block;
      margin-top: 8px;
      margin-bottom: 2px;
      font-weight: 500;
    }

    select,
    input[type="text"],
    input[type="date"],
    input[type="number"] {
      width: 100%;
      padding: 4px;
      box-sizing: border-box;
      font-size: 13px;
    }

    button {
      margin-top: 12px;
      padding: 6px 12px;
      border-radius: 4px;
      border: 1px solid #ccc;
      cursor: pointer;
    }

    #status {
      margin-top: 8px;
      min-height: 18px;
    }

    fieldset {
      margin-top: 8px;
      border: 1px solid #ddd;
      padding: 8px;
    }

    fieldset legend {
      font-size: 12px;
      font-weight: 600;
      padding: 0 4px;
    }

    #dueCustomTimeRow {
      margin-top: 6px;
    }

    #dueCustomTimeRow > div {
      display: flex;
      align-items: center;
      gap: 4px;
    }

    #dueCustomTimeRow input[type="number"] {
      width: 3.2em;
    }
  </style>
</head>
<body>
  <h3>Email Coding</h3>

  <p>Select the codes for this email, then click <strong>Apply</strong>.</p>

  <!-- WHEN -->
  <label for="whenSelect">WHEN</label>
  <select id="whenSelect">
    <option value="">-- select --</option>
    <option value="HP">HP (High Priority)</option>
    <option value="QH">QH (Quick Hit max. 5 mins)</option>
    <option value="TWP">TWP (This Week) Planned</option>
    <option value="TWM">TWM (This Week) Miss</option>
    <option value="TWE">TWE (This Week) Exception</option>
    <option value="NTW">NTW (Not this Week)</option>
  </select>

  <!-- TYPE -->
  <label for="typeSelect">TYPE</label>
  <select id="typeSelect">
    <option value="">-- select --</option>
    <option value="A">(A)ction</option>
    <option value="I">(I)nfo</option>
    <option value="D">(D)elivery</option>
    <option value="Q">(Q)uestion</option>
    <option value="R">(R)esponse</option>
  </select>

  <!-- TIME -->
  <label for="timeSelect">TIME (Effort)</label>
  <select id="timeSelect">
    <option value="">-- select --</option>
    <option value="1m">(1m) 1 minute</option>
    <option value="3m">(3m) 3 minutes</option>
    <option value="5m">(5m) 5 minutes</option>
    <option value="10m">(10m) 10 minutes</option>
    <option value="15m">(15m) 15 minutes</option>
    <option value="30m">(30m) 30 minutes</option>
    <option value="60m">(60m) 60 minutes</option>
    <option value="1h+">(1h+) 1+ hour</option>
  </select>

  <!-- HEADER (user-written, not the subject) -->
  <label for="headerInput">Header</label>
  <input
    id="headerInput"
    type="text"
    placeholder="One sentence summary (user written)"
  />

  <!-- DUE (only used when TYPE = A, but always visible for now) -->
  <fieldset id="dueSection">
    <legend>Due (Action emails)</legend>

    <label for="dueDate">Due date</label>
    <input type="date" id="dueDate" />

    <label for="dueTimeMode">Due time</label>
    <select id="dueTimeMode">
      <option value="">-- none --</option>
      <option value="EOB">EOB</option>
      <option value="EOD">EOD</option>
      <option value="CUSTOM">Custom time</option>
    </select>

    <div id="dueCustomTimeRow">
      <label style="margin-top: 4px;">Custom time</label>
      <div>
        <input
          id="dueHour"
          type="number"
          min="1"
          max="12"
          placeholder="HH"
        />
        :
        <input
          id="dueMinute"
          type="number"
          min="0"
          max="59"
          placeholder="MM"
        />
        <select id="dueAmPm">
          <option value="AM">AM</option>
          <option value="PM">PM</option>
        </select>
        <span>ET</span>
      </div>
    </div>
  </fieldset>

  <button id="applyCodeButton">Apply</button>

  <div id="status"></div>

  <script src="email-coding.js?v=2"></script>
</body>
</html>